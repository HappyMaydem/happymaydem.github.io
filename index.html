<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Maydem üê±‚ú® ‚Äì Papeler√≠a & Fandom</title>
  <meta name="description" content="Papeler√≠a kawaii, fandom K-pop y anime. Compras por WhatsApp con retiro/ despacho.">
  <link rel="icon" href="https://raw.githubusercontent.com/twitter/twemoji/master/assets/72x72/1f431.png" />
  <!-- Tailwind (necesario para los estilos de clases) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* Identidad Happy Maydem ‚Äì pasteles + Comic Sans */
    :root{
      --hm-bg:#ffe6f0;       /* rosado pastel fondo */
      --hm-primary:#5a479e;  /* morado marca (barra superior/acentos) */
      --hm-pink:#fdaecb;     /* rosado men√∫ */
      --hm-dashed:pink;      /* bordes dashed tarjetas */
    }
    body{ font-family:'Comic Sans MS', cursive, sans-serif; background:var(--hm-bg); }
    .hm-card{ border:2px dashed var(--hm-dashed); border-radius:14px; background:#fff }
    .drawer{transition:transform .25s ease}
    .drawer.closed{transform:translateX(100%)}
    .line-clamp-2{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
  </style>
</head>

<body class="text-slate-800">
  <!-- Barra superior promo -->
  <div class="w-full text-center text-white text-sm py-2" style="background:var(--hm-primary)">
    üì¶ Aprovecha los <b>env√≠os gratis</b> por compras sobre <b>$30.000</b> en Stgo
  </div>

  <!-- Encabezado: logo + redes + buscador -->
  <header class="bg-white">
    <div class="max-w-6xl mx-auto px-4 py-3 flex flex-wrap items-center gap-3 justify-between">
      <a href="/" class="flex items-center gap-3">
        <img src="logo.png" alt="Happy Maydem" class="h-16 md:h-20" onerror="this.style.display='none'"/>
        <span class="text-2xl md:text-3xl font-black tracking-tight">Happy Maydem üê±‚ú®</span>
      </a>
      <div class="flex items-center gap-3">
        <a href="https://www.instagram.com/happy.maydem" target="_blank" aria-label="Instagram" class="p-2 rounded-full hover:bg-pink-100">
          <img src="https://img.icons8.com/color/48/instagram-new.png" class="w-6 h-6" alt="Instagram">
        </a>
        <a href="https://www.facebook.com/people/Happy-Maydem/100092744970823/" target="_blank" aria-label="Facebook" class="p-2 rounded-full hover:bg-pink-100">
          <img src="https://img.icons8.com/color/48/facebook-new.png" class="w-6 h-6" alt="Facebook">
        </a>
        <a href="https://www.tiktok.com/@happy.maydem" target="_blank" aria-label="TikTok" class="p-2 rounded-full hover:bg-pink-100">
          <img src="https://img.icons8.com/ios-filled/50/000000/tiktok--v1.png" class="w-5 h-5" alt="TikTok">
        </a>
        <input id="search" type="search" placeholder="¬øQu√© quieres buscar?" class="px-3 py-2 rounded-full border-2" style="border-color:var(--hm-dashed)"/>
        <button id="openCart" class="ml-1 px-4 py-2 rounded-full text-white font-semibold" style="background:var(--hm-primary)">
          üõí Carrito <span id="cartCount" class="font-bold">0</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Banner -->
  <div class="banner">
    <img src="bannerdelgado.png" alt="Banner Happy Maydem" class="w-full block" onerror="this.style.display='none'">
  </div>

  <!-- Men√∫ navegaci√≥n (filtra por categor√≠a dentro de esta p√°gina) -->
  <nav class="w-full text-center py-3" style="background:var(--hm-pink)">
    <a href="#" data-cat="" class="mx-3 text-white font-bold hover:underline">INICIO</a>
    <a href="#" data-cat="Papeler√≠a" class="mx-3 text-white font-bold hover:underline">PAPELER√çA</a>
    <a href="#" data-cat="Peluches" class="mx-3 text-white font-bold hover:underline">PELUCHES</a>
    <a href="#" data-cat="Accesorios" class="mx-3 text-white font-bold hover:underline">ACCESORIOS</a>
    <a href="#" data-cat="K-pop" class="mx-3 text-white font-bold hover:underline">KPOP</a>
    <a href="#" data-cat="Anime" class="mx-3 text-white font-bold hover:underline">ANIME</a>
  </nav>

  <!-- Controles + Grid -->
  <section class="max-w-6xl mx-auto px-4 mt-4">
    <div class="bg-white hm-card p-4 grid md:grid-cols-3 gap-3 items-end">
      <label class="block md:col-span-1">
        <span class="text-sm font-medium">Ordenar</span>
        <select id="sort" class="mt-1 w-full rounded-xl border px-3 py-2">
          <option value="featured">Destacados</option>
          <option value="price_asc">Precio: menor a mayor</option>
          <option value="price_desc">Precio: mayor a menor</option>
          <option value="az">A ‚Üí Z</option>
        </select>
      </label>
      <div class="md:col-span-2 text-sm text-slate-600">
        Usa el buscador de arriba o el men√∫ para filtrar por categor√≠a üíñ
      </div>
    </div>

    <!-- AQU√ç VAN LAS TARJETAS -->
    <div id="grid" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4 py-6"></div>
  </section>

  <!-- ===== CARRITO (drawer) ===== -->
  <aside id="cartDrawer" class="fixed top-0 right-0 w-full max-w-md h-full bg-white border-l border-slate-200 shadow-xl drawer closed z-50">
    <div class="h-full flex flex-col">
      <div class="px-4 py-3 border-b flex items-center gap-3">
        <button id="closeCart" class="text-xl">‚úñ</button>
        <h2 class="font-bold text-lg">Tu carrito</h2>
      </div>
      <div id="cartItems" class="flex-1 overflow-auto divide-y"></div>
      <div class="p-4 border-t space-y-2">
        <div class="flex justify-between font-semibold">
          <span>Total</span><span id="cartTotal">$0</span>
        </div>
        <button id="btnWhatsappCart" class="w-full px-4 py-2 rounded-xl text-white font-semibold hover:opacity-90" style="background:#5a479e">
          Enviar pedido por WhatsApp
        </button>
        <p class="text-xs text-slate-500">No pagas aqu√≠. Te contactamos por WhatsApp para coordinar pago y env√≠o.</p>
      </div>
    </div>
  </aside>

  <!-- ======= SCRIPTS (al final, as√≠ el DOM ya existe) ======= -->
  <script>
    // === CONFIG B√ÅSICA ===
    const STORE = {
      name: "Happy Maydem",
      whatsappNumber: "56995733148", // tu n√∫mero (sin + ni espacios)
      currency: "$",
      freeShippingThreshold: 30000,
    };

    /* === HM_CART: carrito con localStorage + WhatsApp === */
    (function(){
      const LS_KEY = 'hm_cart_v1';
      const load = () => JSON.parse(localStorage.getItem(LS_KEY) || '[]');
      const save = c => localStorage.setItem(LS_KEY, JSON.stringify(c));
      const fmt  = n => STORE.currency + n.toLocaleString('es-CL');

      const api = {
        add({id,title,price,qty=1}) {
          const c = load();
          const f = c.find(i => i.id === id);
          if (f) f.qty += qty; else c.push({id,title,price,qty});
          save(c); api.render();
        },
        get(){ return load(); },
        count(){ return load().reduce((s,i)=>s+i.qty,0); },
        total(){ return load().reduce((s,i)=>s+i.price*i.qty,0); },
        clear(){ save([]); api.render(); },
        fmt,
        whatsAppURL(){
          const cart = load();
          const lines = cart.length ? [
            `Hola! Quiero hacer un pedido en *${STORE.name}*:`,
            ...cart.map(i=>`‚Ä¢ ${i.title} √ó ${i.qty} ‚Äî ${fmt(i.price*i.qty)}`),
            ``,
            `Total: ${fmt(api.total())}`,
            ``,
            `Comuna/Regi√≥n:`,
            `M√©todo de pago (transferencia/efectivo):`
          ] : [`Hola!`];
          return `https://wa.me/${STORE.whatsappNumber}?text=${encodeURIComponent(lines.join('\n'))}`;
        },
        render(){
          const countEl = document.getElementById('cartCount');
          if (countEl) countEl.textContent = api.count();

          const itemsEl = document.getElementById('cartItems');
          const totalEl = document.getElementById('cartTotal');
          const cart = load();

          if (itemsEl && totalEl){
            totalEl.textContent = fmt(api.total());
            itemsEl.innerHTML = cart.length ? cart.map(i=>`
              <div class="flex items-center gap-3 p-3">
                <div class="flex-1">
                  <div class="font-medium">${i.title}</div>
                  <div class="text-sm text-slate-600">${i.qty} √ó ${fmt(i.price)}</div>
                </div>
                <div class="flex items-center gap-2">
                  <button class="px-2 py-1 rounded border" data-act="dec" data-id="${i.id}">‚àí</button>
                  <button class="px-2 py-1 rounded border" data-act="inc" data-id="${i.id}">+</button>
                  <button class="px-2 py-1 rounded border" data-act="del" data-id="${i.id}">üóë</button>
                </div>
              </div>
            `).join('') : `<div class="p-6 text-center text-slate-500">Tu carrito est√° vac√≠o</div>`;

            // acciones cantidad / borrar
            itemsEl.querySelectorAll('button').forEach(b=>{
              b.onclick = ()=>{
                const id = b.dataset.id, act = b.dataset.act;
                const c = load(); const it = c.find(x=>x.id===id); if(!it) return;
                if (act==='inc') it.qty++;
                if (act==='dec') it.qty = Math.max(1, it.qty-1);
                if (act==='del') c.splice(c.findIndex(x=>x.id===id),1);
                save(c); api.render();
              };
            });
          }

          const btnCart = document.getElementById('btnWhatsappCart');
          if (btnCart) btnCart.onclick = ()=> window.open(api.whatsAppURL(), '_blank');
        }
      };

      window.HM_CART = api;

      // abrir/cerrar caj√≥n
      window.addEventListener('DOMContentLoaded', ()=>{
        const openBtn = document.getElementById('openCart');
        const closeBtn = document.getElementById('closeCart');
        const drawer  = document.getElementById('cartDrawer');
        if (openBtn && drawer) openBtn.onclick = ()=> drawer.classList.remove('closed');
        if (closeBtn && drawer) closeBtn.onclick = ()=> drawer.classList.add('closed');
        api.render(); // pintar contador al cargar
      });
    })();

    // === LISTA DE PRODUCTOS (usa IDs √öNICOS) ===
    const ALL_PRODUCTS = [
      { id: "bt21-a5", title: "Libreta BT21 A5", price: 5000, image: "Libreta Bt21.png", category: "Papeler√≠a", tags: ["libreta","bt21"], featured: true },
      { id: "lovelys", title: "Peluches Lovelys Twice Summer (Alternativos)", price: 4000, image: "Lovelys.JPG", category: "Peluches", tags: ["twice","peluche"], featured: false },

      /* Papeler√≠a ‚Äì Kpop Demon Hunters (A5 = 8000, A6 = 4000) */
      { id: "lib-derpy-a6", title: "Cuaderno A6 Derpy", price: 4000, image: "LIB_DERPY.jpg", category: "Papeler√≠a", tags: ["libreta","cuaderno","derpy","kpop demon hunters","huntrix","saja boys"], featured: true },

      { id: "note-huntrix-a5", title: "Cuaderno A5 Huntrix", price: 8000, image: "NOTE_HUNTRIX.jpg", category: "Papeler√≠a", tags: ["libreta","cuaderno","huntrix","kpop demon hunters","saja boys"], featured: true },
      { id: "note-huntrix-a6", title: "Cuaderno A6 Huntrix", price: 4000, image: "NOTE_HUNTRIX.jpg", category: "Papeler√≠a", tags: ["libreta","cuaderno","huntrix","kpop demon hunters","saja boys"], featured: true },

      { id: "note-rumi-a6", title: "Cuaderno A6 Rumi Kpop Demon Hunters", price: 4000, image: "NOTE_RUMI.jpg", category: "Papeler√≠a", tags: ["libreta","cuaderno","rumi","kpop demon hunters","huntrix","saja boys"], featured: true },
      { id: "note-rumi-a5", title: "Cuaderno A5 Rumi Kpop Demon Hunters", price: 8000, image: "NOTE_RUMI.jpg", category: "Papeler√≠a", tags: ["libreta","cuaderno","rumi","kpop demon hunters","huntrix","saja boys"], featured: true },

      { id: "note-zoey-a6", title: "Cuaderno A6 Zoey Kpop Demon Hunters", price: 4000, image: "NOTE_ZOEY.jpg", category: "Papeler√≠a", tags: ["libreta","cuaderno","zoey","kpop demon hunters","huntrix","saja boys"], featured: true },
      { id: "note-zoey-a5", title: "Cuaderno A5 Zoey Kpop Demon Hunters", price: 8000, image: "NOTE_ZOEY.jpg", category: "Papeler√≠a", tags: ["libreta","cuaderno","zoey","kpop demon hunters","huntrix","saja boys"], featured: true },

      { id: "note-mira-a6", title: "Cuaderno A6 Mira Kpop Demon Hunters", price: 4000, image: "NOTE_MIRA.jpg", category: "Papeler√≠a", tags: ["libreta","cuaderno","mira","kpop demon hunters","huntrix","saja boys"], featured: true },
      { id: "note-mira-a5", title: "Cuaderno A5 Mira Kpop Demon Hunters", price: 8000, image: "NOTE_MIRA.jpg", category: "Papeler√≠a", tags: ["libreta","cuaderno","mira","kpop demon hunters","huntrix","saja boys"], featured: true },

      { id: "note-sajaboys-a6", title: "Cuaderno A6 Saja Boys", price: 4000, image: "NOTE_SAJABOYS.jpg", category: "Papeler√≠a", tags: ["libreta","cuaderno","saja boys","kpop demon hunters","huntrix"], featured: true },
      { id: "note-sajaboys-a5", title: "Cuaderno A5 Saja Boys", price: 8000, image: "NOTE_SAJABOYS.jpg", category: "Papeler√≠a", tags: ["libreta","cuaderno","saja boys","kpop demon hunters","huntrix"], featured: true }
    ];

    // Estado de categor√≠a (por men√∫)
    let ACTIVE_CATEGORY = "";

    // Elementos
    const inputSearch = document.getElementById('search');
    const selSort = document.getElementById('sort');
    const grid = document.getElementById('grid');

    // Utils
    const fmtPrice = n => STORE.currency + n.toLocaleString('es-CL');

    function cardHTML(p){
      return `
        <article class="hm-card overflow-hidden shadow-sm hover:shadow transition">
          <img src="${p.image}" alt="${p.title}" class="w-full h-48 object-cover"/>
          <div class="p-4 space-y-2 text-center">
            <h3 class="font-semibold line-clamp-2">${p.title}</h3>
            <div class="text-slate-600 text-sm">${p.category}</div>
            <div class="font-bold">${fmtPrice(p.price)}</div>
            <button data-id="${p.id}" class="btn-add w-full px-4 py-2 rounded-xl text-white font-semibold" style="background:#5a479e">A√±adir al carrito</button>
          </div>
        </article>`;
    }

    function emptyHTML(){
      return `<div class="text-center text-slate-600 py-16">No encontramos productos üòø</div>`;
    }

    function getProducts(){
      let list = [...ALL_PRODUCTS];
      if (ACTIVE_CATEGORY) list = list.filter(p => p.category === ACTIVE_CATEGORY);
      const q = (inputSearch?.value || '').trim().toLowerCase();
      if (q) list = list.filter(p =>
        p.title.toLowerCase().includes(q) ||
        (p.tags||[]).some(t => t.toLowerCase().includes(q))
      );
      switch (selSort?.value) {
        case 'price_asc':  list.sort((a,b)=>a.price-b.price); break;
        case 'price_desc': list.sort((a,b)=>b.price-a.price); break;
        case 'az':         list.sort((a,b)=>a.title.localeCompare(b.title)); break;
        default:           list.sort((a,b)=>Number(b.featured)-Number(a.featured));
      }
      return list;
    }

    function renderProducts(){
      const list = getProducts();
      grid.innerHTML = list.length ? list.map(cardHTML).join('') : emptyHTML();

      // Bot√≥n "A√±adir" (carrito)
      grid.querySelectorAll('.btn-add').forEach(btn=>{
        btn.onclick = ()=>{
          const p = ALL_PRODUCTS.find(x => x.id === btn.dataset.id);
          HM_CART.add({ id: p.id, title: p.title, price: p.price, qty: 1 });
        };
      });
    }

    // Men√∫: filtra por categor√≠a
    document.querySelectorAll('nav [data-cat]').forEach(a=>{
      a.addEventListener('click', (e)=>{
        e.preventDefault();
        ACTIVE_CATEGORY = a.getAttribute('data-cat') || "";
        renderProducts();
        window.scrollTo({ top: grid.offsetTop - 80, behavior: 'smooth' });
      });
    });

    // Eventos
    inputSearch?.addEventListener('input', renderProducts);
    selSort?.addEventListener('input', renderProducts);

    // Init
    renderProducts();
  </script>
</body>
</html>
