<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PapelerÃ­a â€“ Happy Maydem ğŸ±âœ¨</title>
  <meta name="description" content="PapelerÃ­a kawaii: libretas, lÃ¡pices, stickers y mÃ¡s.">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{ --hm-bg:#ffe6f0; --hm-primary:#5a479e; --hm-pink:#fdaecb; --hm-dashed:pink; }
    body{ font-family:'Comic Sans MS', cursive, sans-serif; background:var(--hm-bg); color:#334155 }
    .hm-card{ border:2px dashed var(--hm-dashed); border-radius:14px; background:#fff }
    .drawer{transition:transform .25s ease}.drawer.closed{transform:translateX(100%)}
    .line-clamp-2{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
  </style>
</head>
<body>
  <div class="w-full text-center text-white text-sm py-2" style="background:var(--hm-primary)">ğŸ“š PapelerÃ­a kawaii</div>

  <header class="bg-white">
    <div class="max-w-6xl mx-auto px-4 py-3 flex flex-wrap items-center gap-3 justify-between">
      <a href="index.html" class="flex items-center gap-3">
        <img src="logo.png" class="h-16 md:h-20" onerror="this.style.display='none'"/>
        <span class="text-2xl md:text-3xl font-black">Happy Maydem ğŸ±âœ¨</span>
      </a>
      <div class="flex items-center gap-3">
        <input id="search" type="search" placeholder="Buscar en papelerÃ­aâ€¦" class="px-3 py-2 rounded-full border-2" style="border-color:var(--hm-dashed)"/>
        <button id="openCart" class="px-4 py-2 rounded-full text-white font-semibold" style="background:#5a479e">ğŸ›’ Carrito <span id="cartCount">0</span></button>
      </div>
    </div>
  </header>

  <nav class="w-full text-center py-3" style="background:var(--hm-pink)">
    <a href="index.html" class="mx-3 text-white font-bold">INICIO</a>
    <a href="papeleria.html" class="mx-3 text-white font-bold underline">PAPELERÃA</a>
    <a href="peluches.html" class="mx-3 text-white font-bold">PELUCHES</a>
    <a href="accesorios.html" class="mx-3 text-white font-bold">ACCESORIOS</a>
    <a href="kpop.html" class="mx-3 text-white font-bold">KPOP</a>
    <a href="anime.html" class="mx-3 text-white font-bold">ANIME</a>
  </nav>

  <main class="max-w-6xl mx-auto px-4 py-6">
    <div class="bg-white hm-card p-4 grid md:grid-cols-3 gap-3 items-end">
      <label class="block">
        <span class="text-sm font-medium">Ordenar</span>
        <select id="sort" class="mt-1 w-full rounded-xl border px-3 py-2">
          <option value="featured">Destacados</option>
          <option value="price_asc">Precio: menor a mayor</option>
          <option value="price_desc">Precio: mayor a menor</option>
          <option value="az">A â†’ Z</option>
        </select>
      </label>
    </div>

    <div id="grid" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-4"></div>
  </main>

  <!-- Drawer carrito -->
  <aside id="cartDrawer" class="fixed top-0 right-0 w-full max-w-md h-full bg-white border-l shadow-xl drawer closed z-50">
    <div class="h-full flex flex-col">
      <div class="px-4 py-3 border-b flex items-center gap-3"><button id="closeCart" class="text-xl">âœ–</button><h2 class="font-bold text-lg">Tu carrito</h2></div>
      <div id="cartItems" class="flex-1 overflow-auto divide-y"></div>
      <div class="p-4 border-t space-y-2">
        <div class="flex justify-between font-semibold"><span>Total</span><span id="cartTotal">$0</span></div>
        <button id="btnWhatsappCart" class="w-full px-4 py-2 rounded-xl text-white font-semibold hover:opacity-90" style="background:#5a479e">Enviar pedido por WhatsApp</button>
      </div>
    </div>
  </aside>

  <script>
    // ---------- CONFIG ----------
    const STORE = { name: "Happy Maydem", whatsappNumber: "56995733148", currency: "$" };

    // ---------- CARRITO (igual que en index) ----------
    (function(){
      const LS_KEY='hm_cart_v1', load=()=>JSON.parse(localStorage.getItem(LS_KEY)||'[]'), save=c=>localStorage.setItem(LS_KEY,JSON.stringify(c));
      const fmt=n=>STORE.currency+n.toLocaleString('es-CL');
      const api={
        add({id,title,price,qty=1}){const c=load();const f=c.find(i=>i.id===id); if(f)f.qty+=qty; else c.push({id,title,price,qty}); save(c); api.render();},
        count(){return load().reduce((s,i)=>s+i.qty,0);},
        total(){return load().reduce((s,i)=>s+i.price*i.qty,0);},
        whatsAppURL(){const cart=load();const lines=cart.length?[`Hola! Quiero hacer un pedido en *${STORE.name}*:`,...cart.map(i=>`â€¢ ${i.title} Ã— ${i.qty} â€” ${fmt(i.price*i.qty)}`),``,`Total: ${fmt(api.total())}`,``,`Comuna/RegiÃ³n:`,`MÃ©todo de pago (transferencia/efectivo):`]:[`Hola!`];return `https://wa.me/${STORE.whatsappNumber}?text=${encodeURIComponent(lines.join('\n'))}`;},
        render(){const cc=document.getElementById('cartCount'); if(cc) cc.textContent=api.count(); const items=document.getElementById('cartItems'); const total=document.getElementById('cartTotal'); if(items&&total){const cart=load(); total.textContent=fmt(api.total()); items.innerHTML=cart.length?cart.map(i=>`<div class="flex items-center gap-3 p-3"><div class="flex-1"><div class="font-medium">${i.title}</div><div class="text-sm text-slate-600">${i.qty} Ã— ${fmt(i.price)}</div></div><div class="flex items-center gap-2"><button class="px-2 py-1 rounded border" data-act="dec" data-id="${i.id}">âˆ’</button><button class="px-2 py-1 rounded border" data-act="inc" data-id="${i.id}">+</button><button class="px-2 py-1 rounded border" data-act="del" data-id="${i.id}">ğŸ—‘</button></div></div>`).join(''):`<div class="p-6 text-center text-slate-500">Tu carrito estÃ¡ vacÃ­o</div>`; items.querySelectorAll('button').forEach(b=>{b.onclick=()=>{const id=b.dataset.id,act=b.dataset.act;const c=load();const it=c.find(x=>x.id===id);if(!it)return;if(act==='inc')it.qty++;if(act==='dec')it.qty=Math.max(1,it.qty-1);if(act==='del')c.splice(c.findIndex(x=>x.id===id),1);save(c);api.render();};});} const btn=document.getElementById('btnWhatsappCart'); if(btn) btn.onclick=()=>window.open(api.whatsAppURL(),'_blank');}
      };
      window.HM_CART=api;
      window.addEventListener('DOMContentLoaded',()=>{const o=document.getElementById('openCart'),c=document.getElementById('closeCart'),d=document.getElementById('cartDrawer'); if(o&&d) o.onclick=()=>d.classList.remove('closed'); if(c&&d) c.onclick=()=>d.classList.add('closed'); api.render();});
    })();

    // ---------- PRODUCTOS (solo PapelerÃ­a) ----------
    const ALL_PRODUCTS = [
      { id:'bt21-a5', title:'Libreta BT21 A5', price:5000, image:'Libreta Bt21.png', category:'PapelerÃ­a', tags:['libreta','bt21'], featured:true },
      { id:'note-huntrix-a6', title:'Cuaderno A6 Huntrix', price:4000, image:'Note_Huntrix.png', category:'PapelerÃ­a', tags:['libreta','cuaderno','huntrix'], featured:true },
      { id:'note-rumi-a6',  title:'Cuaderno A6 Rumi', price:4000, image:'Note_Rumi.png', category:'PapelerÃ­a', tags:['libreta','cuaderno','rumi'], featured:true },
      { id:'note-zoey-a6',  title:'Cuaderno A6 Zoey', price:4000, image:'Note_Zoey.png', category:'PapelerÃ­a', tags:['libreta','cuaderno','zoey'], featured:true },
      { id:'note-mira-a6',  title:'Cuaderno A6 Mira', price:4000, image:'Note_Mira.png', category:'PapelerÃ­a', tags:['libreta','cuaderno','mira'], featured:true },
      { id:'note-sajaboys-a6', title:'Cuaderno A6 Saja Boys', price:4000, image:'Note_Sajaboys.png', category:'PapelerÃ­a', tags:['libreta','cuaderno','saja boys'], featured:true },
      { id:'note-charizard-a6', title:'Cuaderno A6 Charizard', price:4000, image:'Chari.png', category:'PapelerÃ­a', tags:['libreta','pokemon'], featured:true },
      { id:'note-charizard2-a6', title:'Cuaderno A6 Charizard 2', price:4000, image:'Charizard.png', category:'PapelerÃ­a', tags:['libreta','pokemon'], featured:true },
      { id:'note-gengar-a6', title:'Cuaderno A6 Gengar', price:4000, image:'Gengar.png', category:'PapelerÃ­a', tags:['libreta','pokemon'], featured:true },
      { id:'note-sylveon-a6', title:'Cuaderno A6 Sylveon', price:4000, image:'Pokemon1.png', category:'PapelerÃ­a', tags:['libreta','pokemon'], featured:true },
      { id:'note-chopper-a6',  title:'Cuaderno A6 Chopper', price:4000, image:'Chopper.png', category:'PapelerÃ­a', tags:['libreta','one piece'], featured:true },
      { id:'note-chopper1-a6', title:'Cuaderno A6 Chopper 1', price:4000, image:'Note_Chopper1.png', category:'PapelerÃ­a', tags:['libreta','one piece'], featured:true },
      { id:'note-chopper2-a6', title:'Cuaderno A6 Chopper 2', price:4000, image:'NoteChopper2.png', category:'PapelerÃ­a', tags:['libreta','one piece'], featured:true },
      { id:'note-frieren-a6', title:'Cuaderno A6 Frieren', price:4000, image:'Frieren.png', category:'PapelerÃ­a', tags:['libreta','frieren'], featured:true },
      { id:'note-maomao-a6', title:'Cuaderno A6 Mao Mao', price:4000, image:'MaoMao.png', category:'PapelerÃ­a', tags:['libreta','boticaria'], featured:true },
      { id:'note-jinshi-a6', title:'Cuaderno A6 Jinshi y Mao Mao', price:4000, image:'Jinshi.png', category:'PapelerÃ­a', tags:['libreta','boticaria'], featured:true },
      { id:'note-okarun-kawaii-a6', title:'Cuaderno A6 Okarun Kawaii', price:4000, image:'Okarun_kawaii.png', category:'PapelerÃ­a', tags:['libreta','dandadan'], featured:true },
      { id:'note-okarun-a6', title:'Cuaderno A6 Okarun', price:4000, image:'Okarun.png', category:'PapelerÃ­a', tags:['libreta','dandadan'], featured:true },
      { id:'note-momo-a6', title:'Cuaderno A6 Momo', price:4000, image:'Momo.png', category:'PapelerÃ­a', tags:['libreta','dandadan'], featured:true },
      { id:'note-turbo-abuela-a6', title:'Cuaderno A6 Turbo Abuela', price:4000, image:'Turbo_Abuela.png', category:'PapelerÃ­a', tags:['libreta','dandadan'], featured:true }
    ];

    // ---------- RENDER ----------
    const search = document.getElementById('search');
    const sort = document.getElementById('sort');
    const grid = document.getElementById('grid');

    const fmt = n => STORE.currency + n.toLocaleString('es-CL');

    function cardHTML(p){
      return `
        <article class="hm-card overflow-hidden shadow-sm hover:shadow transition">
          <img src="${p.image}" alt="${p.title}" class="w-full h-64 sm:h-72 lg:h-80 object-cover"/>
          <div class="p-4 space-y-2 text-center">
            <h3 class="font-semibold line-clamp-2">${p.title}</h3>
            <div class="text-slate-600 text-sm">${p.category}</div>
            <div class="font-bold">${fmt(p.price)}</div>
            <button data-id="${p.id}" class="btn-add w-full px-4 py-2 rounded-xl text-white font-semibold" style="background:#5a479e">AÃ±adir al carrito</button>
          </div>
        </article>`;
    }

    function render(){
      const q = (search?.value||'').toLowerCase().trim();
      let list = ALL_PRODUCTS.filter(p =>
        !q || p.title.toLowerCase().includes(q) || (p.tags||[]).some(t=>String(t).toLowerCase().includes(q))
      );

      switch (sort?.value){
        case 'price_asc':  list.sort((a,b)=>a.price-b.price); break;
        case 'price_desc': list.sort((a,b)=>b.price-a.price); break;
        case 'az':         list.sort((a,b)=>a.title.localeCompare(b.title)); break;
        default:           list.sort((a,b)=>Number(b.featured)-Number(a.featured));
      }

      grid.innerHTML = list.length ? list.map(cardHTML).join('') :
        `<div class="text-center text-slate-600 py-16">No encontramos productos ğŸ˜¿</div>`;

      grid.querySelectorAll('.btn-add').forEach(btn=>{
        btn.onclick = ()=>{
          const p = ALL_PRODUCTS.find(x=>x.id===btn.dataset.id);
          HM_CART.add({ id:p.id, title:p.title, price:p.price, qty:1 });
        };
      });
    }

    // Cargar cuando el DOM estÃ© listo
    window.addEventListener('DOMContentLoaded', render);
    search?.addEventListener('input', render);
    sort?.addEventListener('input', render);
  </script>
</body>
</html>

